<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Moselog</title>
    <link>http://blog.mose.com/</link>
    <description>Recent content on Moselog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Fri, 28 Aug 2015 09:10:31 +0800</lastBuildDate>
    <atom:link href="http://blog.mose.com/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Moving to Hugo</title>
      <link>http://blog.mose.com/2015/08/28/moving-to-hugo</link>
      <pubDate>Fri, 28 Aug 2015 09:10:31 +0800</pubDate>
      
      <guid>http://blog.mose.com/2015/08/28/moving-to-hugo</guid>
      <description>&lt;p&gt;As I love website pre-generation concept I have been using &lt;a href=&#34;http://jekyllrb.com&#34;&gt;Jekyll&lt;/a&gt; and &lt;a href=&#34;http://octopress.org&#34;&gt;Octopress&lt;/a&gt; quite a lot. But now I wanted to give a try to &lt;a href=&#34;http://gohugo.io&#34;&gt;Hugo&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Also, I have had various spaces of blogging in the past few years, so I thought I should just recenter everything in a unique place. There was an old blog on tumblr because I wanted to see how it was made. Then I had a period of time where I was publishing tips on the Faria Devtips website, which is down now. Then I also publish some rants every week on the &lt;a href=&#34;http://greenruby.org&#34;&gt;Greenruby&lt;/a&gt; newsletter.&lt;/p&gt;

&lt;p&gt;Only the last on is still active, so I will cross-post things from there to here, which should not be too hard as they are both markdown.&lt;/p&gt;

&lt;p&gt;The first impression of Hugo is that there are still a lot of small weird things. But in some ways, I&amp;rsquo;m kind of happy about it, I guess I will try to fix some of those, that will be an occasion to play a little with golang.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Console columns</title>
      <link>http://blog.mose.com/2014/09/10/console-columns</link>
      <pubDate>Wed, 10 Sep 2014 12:10:31 +0800</pubDate>
      
      <guid>http://blog.mose.com/2014/09/10/console-columns</guid>
      <description>&lt;p&gt;When you live in your console, it&amp;rsquo;s always good to find ways to stay there. The &lt;code&gt;column&lt;/code&gt; command was recently brought to my attention by &lt;a href=&#34;https://sysadmincasts.com/episodes/36-cli-monday-column-and-tr&#34;&gt;https://sysadmincasts.com/episodes/36-cli-monday-column-and-tr&lt;/a&gt; and despite years of console life, godamn I was unaware of this simple tool.&lt;/p&gt;

&lt;p&gt;It is very useful for displaying csv files in a readable way, for example:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ head members_export_0bfc48c38f.csv
LATITUDE,LONGITUDE,CC,REGION
24.7798,120.93,TW,HSZ
52.0927,5.1158,NL,UT
25.0389,121.509,TW,TPE
47.6836,-122.122,US,WA
24.1403,120.682,TW,TXG
37.4055,-122.078,US,CA
37.4055,-122.078,US,CA
37.4055,-122.078,US,CA
26.1405,-80.1738,US,FL
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;yuck. Let&amp;rsquo;s prettify it.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ head members_export_0bfc48c38f.csv | column -t -s,
LATITUDE  LONGITUDE  CC  REGION
24.7798   120.93     TW  HSZ
52.0927   5.1158     NL  UT
25.0389   121.509    TW  TPE
47.6836   -122.122   US  WA
24.1403   120.682    TW  TXG
37.4055   -122.078   US  CA
37.4055   -122.078   US  CA
37.4055   -122.078   US  CA
26.1405   -80.1738   US  FL
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ohh, my world just changed!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Pretty json</title>
      <link>http://blog.mose.com/2014/09/10/pretty-json</link>
      <pubDate>Wed, 10 Sep 2014 09:10:31 +0800</pubDate>
      
      <guid>http://blog.mose.com/2014/09/10/pretty-json</guid>
      <description>&lt;p&gt;JSON prettifying is a reccurent topic, every coder needs it to keep some sanity. My way to do it has been something like this for a while:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;ruby -rjson -ropen-uri -rawesome_print -e &amp;quot;ap JSON.load(open(&#39;http://jsonip.com/&#39;))&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;{
       &amp;quot;ip&amp;quot; =&amp;gt; &amp;quot;59.115.120.166&amp;quot;,
    &amp;quot;about&amp;quot; =&amp;gt; &amp;quot;/about&amp;quot;,
     &amp;quot;Pro!&amp;quot; =&amp;gt; &amp;quot;http://getjsonip.com&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;because when you are rubyist everything can be solve with ruby, obviously.&lt;/p&gt;

&lt;p&gt;But well, then one day I did&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pip install pjson
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;and then&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;curl -s http://jsonip.com | pjson
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;{
  &amp;quot;Pro!&amp;quot;: &amp;quot;http://getjsonip.com&amp;quot;,
  &amp;quot;about&amp;quot;: &amp;quot;/about&amp;quot;,
  &amp;quot;ip&amp;quot;: &amp;quot;59.115.120.166&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Faster, easier, happier.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Digitalocean CLI</title>
      <link>http://blog.mose.com/2014/08/07/digitalocean-cli</link>
      <pubDate>Thu, 07 Aug 2014 09:10:31 +0800</pubDate>
      
      <guid>http://blog.mose.com/2014/08/07/digitalocean-cli</guid>
      <description>&lt;p&gt;We host some dev boxes on Digitalocean, and I tried varioous CLI because I like to stay in the console. Recently I was pretty happy to find Tugboat, as it saves default droplet size, region and image, and convers the whole API. Its fuzzy droplet name matching also can find great usage.&lt;/p&gt;

&lt;p&gt;The only problem it has, is its counter-intuitive damn name (I forgot how to launch it 2 hours after using it the first time haha).&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/pearkes/tugboat&#34;&gt;https://github.com/pearkes/tugboat&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;img src=&#34;http://res.cloudinary.com/mosepix/image/upload/devtips/2014-08-07-tugboat.png&#34; alt=&#34;tugboat&#34; class=&#34;pure-img&#34; /&gt;


</description>
    </item>
    
    <item>
      <title>Tree command</title>
      <link>http://blog.mose.com/2014/07/11/tree-command</link>
      <pubDate>Fri, 11 Jul 2014 14:10:31 +0800</pubDate>
      
      <guid>http://blog.mose.com/2014/07/11/tree-command</guid>
      <description>&lt;p&gt;There is a shell tool that I install systematically on any new machine/server, it&amp;rsquo;s &lt;code&gt;tree&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;apt-get install tree
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;or&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;brew install tree
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Its very basic usage is to show the content of a dir in an arborescent way, and there are a lot of options. It can be a good alternative to &lt;code&gt;find&lt;/code&gt; sometimes. But I mostly use it for having a quick overview of the content of a dir.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mose@momac &amp;gt; ~ &amp;gt; tree projects/lolita
projects/lolita
├── Gemfile
├── Gemfile.lock
├── README.md
├── config.default.yml
├── config.yml
├── lita-faria
│   ├── Gemfile
│   ├── LICENSE
│   ├── README.md
│   ├── Rakefile
│   ├── lib 
│   │   ├── lita
│   │   │   └── handlers
│   │   │       └── faria.rb
│   │   └── lita-faria.rb
│   ├── lita-faria.gemspec
│   └── spec
│       ├── lita
│       │   └── handlers
│       │       └── faria_spec.rb
│       └── spec_helper.rb
├── lita_config.rb
├── log 
└── tmp 

9 directories, 15 files
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Some options:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mose@momac &amp;gt; ~ &amp;gt; tree projects/lolita -hfih -I &#39;spec|lib&#39; --du
projects/lolita
[ 164]  projects/lolita/Gemfile
[1.2K]  projects/lolita/Gemfile.lock
[1.2K]  projects/lolita/README.md
[ 177]  projects/lolita/config.default.yml
[ 222]  projects/lolita/config.yml
[2.6K]  projects/lolita/lita-faria
[  39]  projects/lolita/lita-faria/Gemfile
[1.0K]  projects/lolita/lita-faria/LICENSE
[ 357]  projects/lolita/lita-faria/README.md
[ 117]  projects/lolita/lita-faria/Rakefile
[ 769]  projects/lolita/lita-faria/lita-faria.gemspec
[1.2K]  projects/lolita/lita_config.rb
[ 102]  projects/lolita/log
[ 102]  projects/lolita/tmp

 7.4K used in 3 directories, 11 files
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;man tree&lt;/code&gt; for more (but the basic tree view is the real deal, for more detailled listings, &lt;code&gt;find&lt;/code&gt; is better).&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>SQL in a shell</title>
      <link>http://blog.mose.com/2014/07/04/sql-in-a-shell</link>
      <pubDate>Fri, 04 Jul 2014 14:10:31 +0800</pubDate>
      
      <guid>http://blog.mose.com/2014/07/04/sql-in-a-shell</guid>
      <description>&lt;p&gt;There is a package that is not installed by default that I now grab systematically, it&amp;rsquo;s called &lt;code&gt;parallel&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;apt-get install parallel
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;or on mac&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;brew install parallel
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;parallel&lt;/code&gt; command is a pretty complex beast, but the package also comes with the &lt;code&gt;sql&lt;/code&gt; command, which simplifies queries to any database from the console. There is just one     command whatever the sql backend you use.&lt;/p&gt;

&lt;p&gt;I first setup my dburl in &lt;code&gt;.sql/aliases&lt;/code&gt; as:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;:dbmb mysql:///managebac
:dboa mysql:///openapply
:dbis psql://isis:password@localhost/intersis
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And I can then use those aliases for quick sql commands:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sql :dbmb &amp;quot;select count(*) from users&amp;quot;
sql --show-processlist :dbis
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Check &lt;a href=&#34;http://www.gnu.org/software/parallel/sql.html&#34;&gt;http://www.gnu.org/software/parallel/sql.html&lt;/a&gt; for more examples of use. Also check &lt;a href=&#34;http://www.gnu.org/software/parallel/package&#34;&gt;http://www.gnu.org/software/parallel/package&lt;/a&gt; it&amp;rsquo;s very powerful, but a bit complicated  to catch it, maybe I will provide some examples of practical use in a later tip.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Knife remote command</title>
      <link>http://blog.mose.com/2014/06/26/knife-remote-command</link>
      <pubDate>Thu, 26 Jun 2014 09:10:31 +0800</pubDate>
      
      <guid>http://blog.mose.com/2014/06/26/knife-remote-command</guid>
      <description>&lt;p&gt;Recently we switched from chef-solo to a chef-server setup on our infrastructure, a good occasion to refactor our recipes to better practices. I spent some time figuring out how to replace the &lt;code&gt;fabric&lt;/code&gt; scripts I had for remote execution of actions on various servers, by using a knife plugin. That way I can just use knife abilities and don&amp;rsquo;t need fabric anymore.&lt;/p&gt;

&lt;p&gt;So I created a new file in &lt;code&gt;.chef/plugins/knife/&lt;/code&gt; named &lt;code&gt;apt.rb&lt;/code&gt; for a test:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;require &#39;chef/knife&#39;

module KnifeOpenvpn
  class Apt &amp;lt; Chef::Knife

    banner &amp;quot;knife apt &amp;lt;update|upgrade|simulate&amp;gt; &amp;lt;nodename&amp;gt;&amp;quot;

    deps do
      require &#39;chef/knife/ssh&#39;
      require &#39;chef/node&#39;
      Chef::Knife::Ssh.load_deps
    end

    def run
      if name_args.size == 2
        command_arg = name_args.shift
        server = name_args.shift
      else
        ui.fatal &amp;quot;Syntax: knife apt &amp;lt;update|upgrade|simulate&amp;gt; &amp;lt;nodename&amp;gt;&amp;quot;
        ui.fatal &amp;quot;Where &amp;lt;nodename&amp;gt; is a node name.&amp;quot;
        exit 1
      end
      command = case command_arg
                when &#39;update&#39;
                  &#39;update&#39;
                when &#39;upgrade&#39;
                  &#39;-y upgrade&#39;
                when &#39;simulate&#39;
                  &#39;-y -s upgrade&#39;
                end
      knife_ssh(Chef::Node.load(server).ipaddress, &amp;quot;sudo apt-get #{command}&amp;quot;).run
    end

    def knife_ssh(server, command)
      ssh = Chef::Knife::Ssh.new
      ssh.name_args = [ server, command ]
      ssh.config[:ssh_user] = Chef::Config[:knife][:ssh_user]
      ssh.config[:ssh_port] = Chef::Config[:knife][:ssh_port]
      ssh.config[:identity_file] = Chef::Config[:knife][:identity_file]
      ssh.config[:ssh_gateway] = Chef::Config[:knife][:ssh_gateway]
      ssh.config[:manual] = true
      ssh.config[:host_key_verify] = Chef::Config[:knife][:host_key_verify]
      ssh.config[:on_error] = :raise
      ssh
    end

  end

end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then I just run a &lt;code&gt;knife apt simulate my-server&lt;/code&gt; to execute a &lt;code&gt;apt-get -s -y upgrade&lt;/code&gt; on the &lt;code&gt;my-server&lt;/code&gt; client node. Pretty useful. But I guess that&amp;rsquo;s only a beginning, I should extend it to run on various nodes at the same time and maybe inside threads or something like that, to match the &lt;code&gt;fabric&lt;/code&gt; power.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Less first</title>
      <link>http://blog.mose.com/2014/06/19/less-first</link>
      <pubDate>Thu, 19 Jun 2014 09:10:31 +0800</pubDate>
      
      <guid>http://blog.mose.com/2014/06/19/less-first</guid>
      <description>

&lt;p&gt;When working on a remote server, I use &lt;code&gt;less&lt;/code&gt; instead of &lt;code&gt;tail&lt;/code&gt; or &lt;code&gt;vi&lt;/code&gt; to check files, the more I can.&lt;/p&gt;

&lt;h2 id=&#34;filter:3480f0a86761ef50d1ed36f6b3b46e94&#34;&gt;filter&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;with &lt;code&gt;&amp;amp;searchstring&lt;/code&gt; it will hide all lines not matching searchstring, like a very simple grep from the console&lt;/li&gt;
&lt;li&gt;just &lt;code&gt;&amp;amp;&lt;/code&gt; with nothing to get back to full view&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;edit-file:3480f0a86761ef50d1ed36f6b3b46e94&#34;&gt;edit file&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;when in &lt;code&gt;less /etc/hosts&lt;/code&gt; if I find out I need to edit it I just type &lt;code&gt;v&lt;/code&gt; it opens it in vi&lt;/li&gt;
&lt;li&gt;when you quit the editor you are back in less&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;follow-mode:3480f0a86761ef50d1ed36f6b3b46e94&#34;&gt;follow mode&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;when in &lt;code&gt;less production.log&lt;/code&gt;, if you want to follow incoming changes type &lt;code&gt;F&lt;/code&gt; it will become like a &lt;code&gt;tail -f&lt;/code&gt; but it keeps the syntax highlighting that was made with a &lt;code&gt;/&lt;/code&gt; search - when in follow mode with &lt;code&gt;F&lt;/code&gt; you can &lt;code&gt;ctrl-c&lt;/code&gt; any time and examine the new stuff&lt;/li&gt;
&lt;li&gt;note that if you are in filter mode the follow respects it (like if you did a &lt;code&gt;grep something/var/log/auth.log | grep &#39;Invalid user&#39;&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;multifiles:3480f0a86761ef50d1ed36f6b3b46e94&#34;&gt;multifiles&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;you can open several file and navigate like in vim with &lt;code&gt;:n&lt;/code&gt; and &lt;code&gt;:p&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;when less is open you can open a new file with &lt;code&gt;:e&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;call-options-inside-less:3480f0a86761ef50d1ed36f6b3b46e94&#34;&gt;call options inside less&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;you can call any launch option from inside less, one I use often is &lt;code&gt;-S&lt;/code&gt; that will enable/disable wrapping of long lines, very useful when parsing web server log files&lt;/li&gt;
&lt;li&gt;to disable/enable search highlighting just &lt;code&gt;-G&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;any other launch option can be called from inside less, pretty convenient&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>S3 backups</title>
      <link>http://blog.mose.com/2014/06/12/s3-backups</link>
      <pubDate>Thu, 12 Jun 2014 09:10:31 +0800</pubDate>
      
      <guid>http://blog.mose.com/2014/06/12/s3-backups</guid>
      <description>&lt;p&gt;We use S3 to backup various kind of files on MB. We use the very convenient backup gem for that (we still use 3.9.0).&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://meskyanichi.github.io/backup/v4/&#34;&gt;http://meskyanichi.github.io/backup/v4/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;But at some point it appeared that backing up our audio recording was hammering disk IO on our server, because the syncer is calculating md5 footprint for each file each time a backup happens. When you get thousands of big files that is pretty expensive process (in our case 20k files and 50G total).&lt;/p&gt;

&lt;p&gt;So I added a small trick there:&lt;/p&gt;

&lt;p&gt;in &lt;code&gt;Backup/models/backup_audio.rb&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;module Backup::Syncer::Cloud
  class Base &amp;lt; Syncer::Base
    def process_orphans
      if @orphans.is_a?(Queue)
        @orphans = @orphans.size.times.map { @orphans.shift }
      end
      &amp;quot;Older Files: #{ @orphans.count }&amp;quot;
    end
  end
end

Backup::Model.new(:backup_audio, &#39;Audio files Backup to S3&#39;) do

  before do
    system(&amp;quot;/Backup/latest_audio.sh&amp;quot;)
  end

  after do
    FileUtils.rm_rf(&amp;quot;/tmp/streams&amp;quot;)
  end

  ##
  # Amazon Simple Storage Service [Syncer]
  #
  sync_with Cloud::S3 do |s3|
    s3.access_key_id     = &amp;quot;xxx&amp;quot;
    s3.secret_access_key = &amp;quot;xxx&amp;quot;
    s3.bucket            = &amp;quot;bucket_backup&amp;quot;
    s3.region            = &amp;quot;us-east-1&amp;quot;
    s3.path              = &amp;quot;/mb_audio_backup&amp;quot;
    s3.mirror            = false
    s3.thread_count      = 50

    s3.directories do |directory|
      directory.add &amp;quot;/tmp/streams&amp;quot;
    end
  end
end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;and in &lt;code&gt;Backup/latest_audio.sh&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#!/bin/sh
# isolate files changed in the last 3 days

TMPDIR=/tmp/streams

mkdir $TMPDIR
for i in `find /storage/audio/ -type f -cmin -4320`; do
  ln -s $i $TMPDIR
done
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It creates a fake backup dir with links to the files that actually changed in the last 3 days and patches the syncer to avoid flooding the logs with orphan files. When sometimes S3 upload fails on one file (and it happens from time to time for &amp;lsquo;amazonian&amp;rsquo; reason) it will be caught on the next daily backup.&lt;/p&gt;

&lt;p&gt;The result was pretty obvious on our disk usage with our daily backups:&lt;/p&gt;

&lt;img src=&#34;http://res.cloudinary.com/mosepix/image/upload/devtips/2014-06-12-s3backup.png&#34; alt=&#34;graph&#34; class=&#34;pure-img&#34; /&gt;



&lt;p&gt;in the logs:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[2014/06/10 07:00:25][info] Summary:
[2014/06/10 07:00:25][info]   Transferred Files: 5
[2014/06/10 07:00:25][info]   Older Files: 22371
[2014/06/10 07:00:25][info]   Unchanged Files: 16
[2014/06/10 07:00:25][info] Syncer::Cloud::S3 Finished!
[2014/06/10 07:00:25][info] Backup for &#39;Audio files Backup to S3 (backup_audio)&#39; Completed Successfully in 00:00:22
[2014/06/10 07:00:25][info] After Hook Starting...
[2014/06/10 07:00:25][info] After Hook Finished.
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Make a gem</title>
      <link>http://blog.mose.com/2014/06/04/make-a-gem</link>
      <pubDate>Wed, 04 Jun 2014 09:10:31 +0800</pubDate>
      
      <guid>http://blog.mose.com/2014/06/04/make-a-gem</guid>
      <description>

&lt;p&gt;Making and publishing your own gems is so incredibly simple. Here is my setp by step process when I want to publish one:&lt;/p&gt;

&lt;h2 id=&#34;make-a-rubygems-account:a6c8c79e924ce88903bef7ff7392e41e&#34;&gt;Make a Rubygems account&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;first ensure create an ccount on &lt;a href=&#34;https://rubygems.org/&#34;&gt;https://rubygems.org/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;initialize your credentials:&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;curl -u username https://rubygems.org/api/v1/api_key.yaml &amp;gt; ~/.gem/credentials
Enter host password for user &#39;username&#39;:

chmod 0600 ~/.gem/credentials
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;prepare-the-code:a6c8c79e924ce88903bef7ff7392e41e&#34;&gt;Prepare the code&lt;/h2&gt;

&lt;p&gt;These steps are my typical path, nothing is really mandatory there.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;create a repo at github (or wherever you want)&lt;/li&gt;
&lt;li&gt;create a base gem skeleton &lt;code&gt;bundle gem mycoolgem&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;update the README.md, add some minimal information. The clearest you explain what it does the best chances people will adopt it. Add cypirght information&lt;/li&gt;
&lt;li&gt;create a CHANGELOG.md because when you publish something you need a clear log of your version changes&lt;/li&gt;
&lt;li&gt;enable the tracking on &lt;a href=&#34;https://codeclimate.com/&#34;&gt;codeclimate&lt;/a&gt;, &lt;a href=&#34;https://travis-ci.org/&#34;&gt;travis&lt;/a&gt;, &lt;a href=&#34;https://coveralls.io/&#34;&gt;coveralls&lt;/a&gt;, &lt;a href=&#34;https://gemnasium.com&#34;&gt;gemnasium&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;add badges from &lt;a href=&#34;http://shields.io&#34;&gt;http://shields.io&lt;/a&gt; in the README.md because it helps to qualify the state of the code quickly&lt;/li&gt;
&lt;li&gt;when the gem code don&amp;rsquo;t need to have access to the version number, I found convenient to just remove the version file and add version in the .gemspec from the changelog file with &lt;code&gt;spec.version  = File.read(File.expand_path(&#39;../CHANGELOG.md&#39;, __FILE__))[/([0-9]+\.[0-9]+\.[0-9]+)/]&lt;/code&gt;
(so then when I version bump there is only one file to edit)&lt;/li&gt;
&lt;li&gt;write the code (or copy it from the private app you extract it from)&lt;/li&gt;
&lt;li&gt;add a spec/ or test/ dir and write some tests and try to reach a decent coverage&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;release-it:a6c8c79e924ce88903bef7ff7392e41e&#34;&gt;Release it&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;add the date in the changelog for the current version&lt;/li&gt;
&lt;li&gt;&lt;code&gt;rake release&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;bump the version to the next increment in the changelog (and version file if any)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Overall with the initial bundle command and the final rake task for release, it&amp;rsquo;s pretty straightforward.&lt;/p&gt;

&lt;p&gt;Also check &lt;a href=&#34;http://guides.rubygems.org/make-your-own-gem/&#34;&gt;http://guides.rubygems.org/make-your-own-gem/&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Gem reverse dependencies</title>
      <link>http://blog.mose.com/2014/05/27/gem-reverse-dependencies</link>
      <pubDate>Tue, 27 May 2014 09:10:31 +0800</pubDate>
      
      <guid>http://blog.mose.com/2014/05/27/gem-reverse-dependencies</guid>
      <description>&lt;p&gt;I have been looking for a way to see what gem uses a gem, so I can see examples of integration in other projects. The rubygems API guide don&amp;rsquo;t tell anything about such reverse dependency query. But it is actually there, it got merged some time ago, and optimized, but it is not documented yet (it runs really fast, kudos Rubygems guys).&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;ruby -ropen-uri -rpp -ryaml \
     -e &#39;pp YAML.load(open(&amp;quot;https://rubygems.org/api/v1/gems/rails_best_practices/reverse_dependencies.yaml&amp;quot;))&#39;

[&amp;quot;metric_fu&amp;quot;,
 &amp;quot;flyerhzm-metric_fu&amp;quot;,
 &amp;quot;edouard-metric_fu&amp;quot;,
 &amp;quot;devver-metric_fu&amp;quot;,
 &amp;quot;goldstar-metric_fu&amp;quot;,
 &amp;quot;socializer&amp;quot;,
 &amp;quot;trollface&amp;quot;,
 &amp;quot;guard-rails_best_practices&amp;quot;,
 &amp;quot;rferraz-metric_fu&amp;quot;,
 &amp;quot;git-hooks-helper&amp;quot;,
 &amp;quot;odor&amp;quot;,
 &amp;quot;rake_check&amp;quot;,
 &amp;quot;koality&amp;quot;,
 &amp;quot;danmayer-metric_fu&amp;quot;,
 &amp;quot;bf4-metric_fu&amp;quot;,
 &amp;quot;metrics_satellite&amp;quot;,
 &amp;quot;code_hunter&amp;quot;,
 &amp;quot;kinit&amp;quot;,
 &amp;quot;rails-audit&amp;quot;,
 &amp;quot;pronto-rails_best_practices&amp;quot;,
 &amp;quot;free_disk_space&amp;quot;,
 &amp;quot;warder&amp;quot;,
 &amp;quot;ruby_osx_app&amp;quot;,
 &amp;quot;sanelint&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Out of curiosity I counted some wellknown gems usages by adding a &lt;code&gt;.count&lt;/code&gt; at the end:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rake:    23766
rails:   6283
thor:    2786
pry:     2870
sinatra: 1964
devise:  422 
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Hackpad cli</title>
      <link>http://blog.mose.com/2014/05/22/hackpad-cli</link>
      <pubDate>Thu, 22 May 2014 09:10:31 +0800</pubDate>
      
      <guid>http://blog.mose.com/2014/05/22/hackpad-cli</guid>
      <description>&lt;p&gt;In Faria we use hackpad a lot, it&amp;rsquo;s pretty useful. Mose made a command line interface so he can download all the pads locally and grep them all in one go. It also transforms the markdown much better than the original hackpad markdown export, which totally sucks (as for now). So pads can be recycled easily in github wiki pages.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/mose/hackpad-cli&#34;&gt;https://github.com/mose/hackpad-cli&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Eddie Vim and rcfiles</title>
      <link>http://blog.mose.com/2014/05/15/eddie-vim-and-rcfiles</link>
      <pubDate>Thu, 15 May 2014 09:10:31 +0800</pubDate>
      
      <guid>http://blog.mose.com/2014/05/15/eddie-vim-and-rcfiles</guid>
      <description>&lt;p&gt;Mose sometimes uses vim on the side of ST3, and can&amp;rsquo;t do it without the pretty good eddie kao set of config files.&lt;/p&gt;

&lt;p&gt;Check it out at &lt;a href=&#34;https://github.com/kaochenlong/eddie-vim&#34;&gt;https://github.com/kaochenlong/eddie-vim&lt;/a&gt; it&amp;rsquo;s tailored for rails dev. I gathered it (plus my oh-my-zsh setup) in my github rcfiles repo &lt;a href=&#34;https://github.com/mose/rcfiles&#34;&gt;https://github.com/mose/rcfiles&lt;/a&gt; with an installer that I runs when I install a new server.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Dictionnary in sublimetext</title>
      <link>http://blog.mose.com/2014/05/08/dictionnary-in-sublimetext</link>
      <pubDate>Thu, 08 May 2014 09:10:31 +0800</pubDate>
      
      <guid>http://blog.mose.com/2014/05/08/dictionnary-in-sublimetext</guid>
      <description>&lt;p&gt;I recently have been annoyed by his own typoes and has been looking for a way to fix it. This is actually pretty simple to &lt;code&gt;cmd-shift-p&lt;/code&gt; and install a package called &lt;code&gt;Dictionnaries&lt;/code&gt;. Then by hitting &lt;code&gt;F6&lt;/code&gt; you switch on and off the spellcheck highlighting. When you write a lot of documentation that is very helpful (and you want to write a lot of documentation, don&amp;rsquo;t you ?).&lt;/p&gt;

&lt;p&gt;The spellcheck auto-highlight can be enabled for specific file extensions (like .md files) by adding&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;quot;spell_check&amp;quot;: true
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;in &lt;code&gt;preferences &amp;gt; Settings - more &amp;gt; Syntax specific - user&lt;/code&gt; (while having a markdown page open)&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>SSH to socket</title>
      <link>http://blog.mose.com/2014/05/01/ssh-to-socket</link>
      <pubDate>Thu, 01 May 2014 09:10:31 +0800</pubDate>
      
      <guid>http://blog.mose.com/2014/05/01/ssh-to-socket</guid>
      <description>&lt;p&gt;I use a special trick because he&amp;rsquo;s often ssh&amp;rsquo;ing all over the place. Add in your &lt;code&gt;.ssh/config&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Host *
  ControlMaster auto
  ControlPath /tmp/%r@%h:%p
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It will save your first connection to a host as a socket in &lt;code&gt;/tmp&lt;/code&gt; and then all subsequent ssh connections to the same host are open instantly because there is no key renegotiation  on the way. The side effect is that the child-connections cannot be closed until the first one closes, but I find it convenient because it tells me that I still have a console open  on the server that I should close.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>